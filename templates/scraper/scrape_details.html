{% extends 'base.html' %}
{% load static %}

{% block title %}ğŸ“Š Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¬Ø²Ø¦ÛŒØ§Øª Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ - Realtime{% endblock %}

{% block content %}
<div class="container">
    <!-- Ø¹Ù†ÙˆØ§Ù† -->
    <div class="header-section">
        <h1>ğŸ“Š Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¬Ø²Ø¦ÛŒØ§Øª Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§</h1>
        <p class="subtitle">Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø®ÙˆØ¯Ú©Ø§Ø± Ùˆ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ´Ø¯Ù‡</p>
    </div>

    <!-- Ø¢Ù…Ø§Ø± -->
    <div class="stats-section">
        <div class="stat-card stat-total">
            <div class="stat-icon">ğŸ“¦</div>
            <div class="stat-content">
                <div class="stat-number" id="stat-total">{{ stats.total }}</div>
                <div class="stat-label">Ú©Ù„ Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§</div>
            </div>
        </div>

        <div class="stat-card stat-success">
            <div class="stat-icon">âœ…</div>
            <div class="stat-content">
                <div class="stat-number" id="stat-scraped">{{ stats.scraped }}</div>
                <div class="stat-label">Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø´Ø¯Ù‡</div>
            </div>
        </div>

        <div class="stat-card stat-warning">
            <div class="stat-icon">â³</div>
            <div class="stat-content">
                <div class="stat-number" id="stat-remaining">{{ stats.remaining }}</div>
                <div class="stat-label">Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡</div>
            </div>
        </div>

        <div class="stat-card stat-info">
            <div class="stat-icon">ğŸ”„</div>
            <div class="stat-content">
                <div class="stat-number" id="stat-current">{{ stats.current }}</div>
                <div class="stat-label">Ø¯Ø±Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…</div>
            </div>
        </div>
    </div>

    <!-- Ù†ÙˆØ§Ø± Ù¾ÛŒØ´Ø±ÙØª -->
    <div class="progress-section">
        <div class="progress-header">
            <span>ğŸ“ˆ Ù¾ÛŒØ´Ø±ÙØª Ø§Ø³ØªØ®Ø±Ø§Ø¬</span>
            <span class="progress-text">
                <strong id="progress-done">{{ stats.scraped }}</strong> Ø§Ø² <strong id="progress-total">{{ stats.total }}</strong>
            </span>
        </div>
        <div class="progress-bar-container">
            <div class="progress-bar" id="progress-bar" style="width: 0%">
                <span class="progress-percent" id="progress-percent">0%</span>
            </div>
        </div>
    </div>

    <!-- Ù¾ÛŒØ§Ù… ÙˆØ¶Ø¹ÛŒØª -->
    <div class="message-container">
        {% if message %}
            <div class="message {% if 'ØªÙ…Ø§Ù…' in message or 'Ø°Ø®ÛŒØ±Ù‡' in message %}success{% elif 'Ø®Ø·Ø§' in message %}error{% else %}warning{% endif %}" id="status-message">
                {{ message }}
            </div>
        {% else %}
            <div class="message info" id="status-message">
                ğŸ”„ Ø¢Ù…Ø§Ø¯Ù‡ Ø´Ø±ÙˆØ¹ Ø§Ø³Øª. Ø¯Ú©Ù…Ù‡ Ø²ÛŒØ± Ø±Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.
            </div>
        {% endif %}
    </div>

    <!-- Ø¯Ú©Ù…Ù‡ Ø´Ø±ÙˆØ¹ -->
    <div class="action-card">
        <div class="action-header">
            <h5>ğŸš€ Ø´Ø±ÙˆØ¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø®ÙˆØ¯Ú©Ø§Ø±</h5>
        </div>
        <div class="action-body">
            <button 
                type="button" 
                id="start-btn" 
                class="btn btn-lg btn-success"
                onclick="startAutoExtraction()"
            >
                â–¶ï¸ Ø´Ø±ÙˆØ¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø®ÙˆØ¯Ú©Ø§Ø±
            </button>
            <button 
                type="button" 
                id="pause-btn" 
                class="btn btn-lg btn-warning" 
                onclick="pauseExtraction()"
                style="display: none;"
            >
                â¸ï¸ Ù…ØªÙˆÙ‚Ù Ú©Ù†
            </button>
            <button 
                type="button" 
                id="resume-btn" 
                class="btn btn-lg btn-info" 
                onclick="resumeExtraction()"
                style="display: none;"
            >
                â–¶ï¸ Ø§Ø¯Ø§Ù…Ù‡ Ø¨Ø¯Ù‡
            </button>

            <!-- Loading Spinner -->
            <div class="spinner-container" id="spinner-container" style="display: none;">
                <div class="spinner"></div>
                <p id="loading-text">â³ Ø¯Ø± Ø­Ø§Ù„ Ø§Ø³ØªØ®Ø±Ø§Ø¬...</p>
            </div>

            <div class="info-box">
                <h6>âš¡ Ù†Ú©Ø§Øª Ù…Ù‡Ù…:</h6>
                <ul>
                    <li>âœ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø®ÙˆØ¯Ú©Ø§Ø±: Ù‡Ø± Ø¢Ú¯Ù‡ÛŒ ÛŒÚ©ÛŒ ÛŒÚ©ÛŒ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…ÛŒâ€ŒØ´ÙˆØ¯</li>
                    <li>ğŸ“Š Ù¾ÛŒØ´Ø±ÙØª Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ: ØªÙ…Ø§Ù… Ø§Ø¹Ø¯Ø§Ø¯ Ø¢Ù†ÛŒ Ø¢Ù¾Ø¯ÛŒØª Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯</li>
                    <li>â¸ï¸ ØªÙˆÙ‚Ù Ù…ÙˆÙ‚Øª: Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¯Ø± Ù‡Ø± Ù„Ø­Ø¸Ù‡ Ù…ØªÙˆÙ‚Ù Ú©Ù†ÛŒØ¯</li>
                    <li>â±ï¸ Ø²Ù…Ø§Ù†â€ŒØ¨Ù†Ø¯ÛŒ: Ù‡Ø± Ø¢Ú¯Ù‡ÛŒ Û²-Û´ Ø«Ø§Ù†ÛŒÙ‡ Ø²Ù…Ø§Ù† Ù…ÛŒâ€ŒØ¨Ø±Ø¯</li>
                    <li>ğŸ¯ Ø¯Ù‚Øª: Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù‚Ø¨Ù„ Ùˆ Ø¨Ø¹Ø¯ Ø§Ø² Ù‡Ø± Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªÙØµÛŒÙ„ÛŒ -->
    <div class="details-section">
        <div class="detail-card">
            <h6>ğŸ“‹ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø³ØªØ®Ø±Ø§Ø¬â€ŒØ´Ø¯Ù‡</h6>
            <div class="info-grid">
                <div class="info-item">ğŸ’° Ù‚ÛŒÙ…Øª</div>
                <div class="info-item">ğŸ“… Ø³Ø§Ù„ Ø³Ø§Ø®Øª</div>
                <div class="info-item">ğŸ›£ï¸ Ú©Ø§Ø±Ú©Ø±Ø¯ (KM)</div>
                <div class="info-item">ğŸ¨ Ø±Ù†Ú¯</div>
                <div class="info-item">â›½ Ù†ÙˆØ¹ Ø³ÙˆØ®Øª</div>
                <div class="info-item">âš™ï¸ Ú¯ÛŒØ±Ø¨Ú©Ø³</div>
                <div class="info-item">ğŸš™ Ø¨Ø±Ù†Ø¯</div>
                <div class="info-item">ğŸš— ØªÛŒÙ¾ Ø®ÙˆØ¯Ø±Ùˆ</div>
                <div class="info-item">ğŸ”§ ÙˆØ¶Ø¹ÛŒØª Ù…ÙˆØªÙˆØ±</div>
                <div class="info-item">ğŸ› ï¸ ÙˆØ¶Ø¹ÛŒØª Ø´Ø§Ø³ÛŒ</div>
                <div class="info-item">ğŸš— ÙˆØ¶Ø¹ÛŒØª Ø¨Ø¯Ù†Ù‡</div>
                <div class="info-item">ğŸ›¡ï¸ Ø¨ÛŒÙ…Ù‡</div>
            </div>
        </div>

        <div class="detail-card">
            <h6>âš™ï¸ Ú†Ú¯ÙˆÙ†Ú¯ÛŒ Ú©Ø§Ø± Ú©Ø±Ø¯Ù†</h6>
            <ol>
                <li>Ø¯Ú©Ù…Ù‡ "Ø´Ø±ÙˆØ¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø®ÙˆØ¯Ú©Ø§Ø±" Ø±Ø§ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯</li>
                <li>Ø³ÛŒØ³ØªÙ… ÛŒÚ© Ø¢Ú¯Ù‡ÛŒ Ø±Ø§ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù…ÛŒâ€ŒÚ©Ù†Ø¯</li>
                <li>Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙÙˆØ±ÛŒ Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯</li>
                <li>Ø¢Ù…Ø§Ø± Ùˆ Ù¾ÛŒØ´Ø±ÙØª Ø¢Ù†ÛŒ Ø¢Ù¾Ø¯ÛŒØª Ù…ÛŒâ€ŒØ´ÙˆØ¯</li>
                <li>Ø³ÛŒØ³ØªÙ… Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ù‡ Ø¢Ú¯Ù‡ÛŒ Ø¨Ø¹Ø¯ÛŒ Ù…ÛŒâ€ŒØ±ÙˆØ¯</li>
                <li>ØªØ§ ØªÙ…Ø§Ù… Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø´ÙˆÙ†Ø¯ Ø§Ø¯Ø§Ù…Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯</li>
            </ol>
        </div>
    </div>

    <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ø§ÙˆØ¨Ø±ÛŒ -->
    <div class="nav-buttons">
        <a href="{% url 'home' %}" class="btn btn-primary">
            ğŸ  Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø®Ø§Ù†Ù‡
        </a>
        <a href="{% url 'analyze_product' %}" class="btn btn-info">
            ğŸ” ØªØ­Ù„ÛŒÙ„ Ø¢Ú¯Ù‡ÛŒ Ø¬Ø¯ÛŒØ¯
        </a>
    </div>
</div>

<style>
    .header-section {
        text-align: center;
        color: white;
        margin-bottom: 40px;
    }

    .header-section h1 {
        font-size: 2.5rem;
        margin-bottom: 10px;
        text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    .subtitle {
        font-size: 16px;
        color: rgba(255,255,255,0.9);
    }

    .stats-section {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .stat-card {
        background: white;
        padding: 20px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        gap: 15px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
    }

    .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    }

    .stat-icon {
        font-size: 2rem;
    }

    .stat-content {
        flex: 1;
    }

    .stat-number {
        font-size: 28px;
        font-weight: bold;
        line-height: 1;
        transition: all 0.3s ease;
    }

    .stat-label {
        color: #888;
        font-size: 12px;
        margin-top: 5px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .stat-total .stat-number { color: #667eea; }
    .stat-success .stat-number { color: #28a745; }
    .stat-warning .stat-number { color: #ffc107; }
    .stat-info .stat-number { color: #17a2b8; }

    .progress-section {
        background: white;
        padding: 20px;
        border-radius: 12px;
        margin-bottom: 30px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    .progress-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 15px;
        color: #333;
        font-weight: bold;
    }

    .progress-text {
        color: #667eea;
    }

    .progress-bar-container {
        width: 100%;
        height: 40px;
        background: #f0f0f0;
        border-radius: 20px;
        overflow: hidden;
        position: relative;
    }

    .progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #28a745 0%, #20c997 100%);
        transition: width 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        min-width: 50px;
    }

    .progress-percent {
        color: white;
        font-weight: bold;
        font-size: 13px;
        text-shadow: 0 1px 2px rgba(0,0,0,0.2);
    }

    .message-container {
        margin-bottom: 20px;
    }

    .message {
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        font-weight: bold;
        font-size: 16px;
        animation: slideDown 0.3s ease;
    }

    .message.success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
    }

    .message.error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
    }

    .message.warning {
        background: #fff3cd;
        color: #856404;
        border: 1px solid #ffeaa7;
    }

    .message.info {
        background: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
    }

    @keyframes slideDown {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .action-card {
        background: white;
        border-radius: 12px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        margin-bottom: 30px;
        overflow: hidden;
    }

    .action-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
    }

    .action-header h5 {
        margin: 0;
        font-size: 18px;
    }

    .action-body {
        padding: 25px;
    }

    .btn {
        padding: 12px 30px;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        display: inline-block;
        text-decoration: none;
        margin-bottom: 15px;
        margin-left: 10px;
    }

    .btn:first-child {
        margin-left: 0;
    }

    .btn-lg {
        width: 100%;
        padding: 15px;
        font-size: 18px;
        margin-left: 0;
        margin-right: 0;
    }

    .btn-success {
        background: #28a745;
        color: white;
    }

    .btn-success:hover:not(:disabled) {
        background: #218838;
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
    }

    .btn-warning {
        background: #ffc107;
        color: #333;
    }

    .btn-warning:hover:not(:disabled) {
        background: #ffb300;
        transform: translateY(-2px);
    }

    .btn-info {
        background: #17a2b8;
        color: white;
    }

    .btn-info:hover:not(:disabled) {
        background: #138496;
        transform: translateY(-2px);
    }

    .btn-primary {
        background: #007bff;
        color: white;
    }

    .btn-primary:hover {
        background: #0056b3;
    }

    .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    /* Spinner Loading */
    .spinner-container {
        text-align: center;
        padding: 30px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 15px;
    }

    .spinner {
        width: 50px;
        height: 50px;
        border: 4px solid #f3f3f3;
        border-top: 4px solid #28a745;
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    #loading-text {
        color: #28a745;
        font-weight: bold;
        margin: 0;
    }

    .info-box {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        margin-top: 20px;
        border-right: 4px solid #667eea;
    }

    .info-box h6 {
        color: #333;
        margin-bottom: 12px;
        font-size: 14px;
        font-weight: bold;
    }

    .info-box ul {
        list-style: none;
        padding: 0;
    }

    .info-box li {
        color: #555;
        margin-bottom: 8px;
        font-size: 13px;
        padding-right: 10px;
    }

    .details-section {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .detail-card {
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    .detail-card h6 {
        color: #333;
        margin-bottom: 15px;
        font-size: 16px;
        font-weight: bold;
        border-bottom: 2px solid #667eea;
        padding-bottom: 10px;
    }

    .info-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
    }

    .info-item {
        background: #f8f9fa;
        padding: 10px;
        border-radius: 6px;
        font-size: 13px;
        color: #555;
    }

    .detail-card ol {
        padding-right: 20px;
        color: #555;
        font-size: 14px;
        line-height: 1.8;
    }

    .detail-card li {
        margin-bottom: 10px;
    }

    .nav-buttons {
        display: flex;
        gap: 15px;
        justify-content: center;
        flex-wrap: wrap;
        padding: 20px;
        background: rgba(255,255,255,0.1);
        border-radius: 12px;
    }

    @media (max-width: 768px) {
        .header-section h1 {
            font-size: 1.8rem;
        }

        .stats-section {
            grid-template-columns: repeat(2, 1fr);
        }

        .btn-lg {
            margin-bottom: 10px;
        }

        .details-section {
            grid-template-columns: 1fr;
        }

        .info-grid {
            grid-template-columns: 1fr;
        }

        .nav-buttons {
            flex-direction: column;
        }

        .nav-buttons .btn {
            width: 100%;
            margin-left: 0;
        }
    }
</style>

<script>
    let isRunning = false;
    let isPaused = false;

    function startAutoExtraction() {
        isRunning = true;
        isPaused = false;
        document.getElementById('start-btn').style.display = 'none';
        document.getElementById('pause-btn').style.display = 'inline-block';
        document.getElementById('resume-btn').style.display = 'none';
        document.getElementById('spinner-container').style.display = 'flex';
        document.getElementById('status-message').style.display = 'none';
        
        extractNext();
    }

    function pauseExtraction() {
        isPaused = true;
        document.getElementById('pause-btn').style.display = 'none';
        document.getElementById('resume-btn').style.display = 'inline-block';
        document.getElementById('spinner-container').style.display = 'none';
    }

    function resumeExtraction() {
        isPaused = false;
        document.getElementById('pause-btn').style.display = 'inline-block';
        document.getElementById('resume-btn').style.display = 'none';
        document.getElementById('spinner-container').style.display = 'flex';
        
        extractNext();
    }

    function extractNext() {
        if (!isRunning || isPaused) {
            return;
        }

        fetch('{% url "scrape_details_api" %}', {
            method: 'POST',
            headers: {
                'X-CSRFToken': '{{ csrf_token }}',
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({})
        })
        .then(response => response.json())
        .then(data => {
            // Ø¢Ù¾Ø¯ÛŒØª Ø¢Ù…Ø§Ø±
            document.getElementById('stat-total').textContent = data.total;
            document.getElementById('stat-scraped').textContent = data.scraped;
            document.getElementById('stat-remaining').textContent = data.remaining;
            document.getElementById('stat-current').textContent = data.scraped;
            
            // Ø¢Ù¾Ø¯ÛŒØª Ù¾ÛŒØ´Ø±ÙØª
            document.getElementById('progress-done').textContent = data.scraped;
            document.getElementById('progress-total').textContent = data.total;
            document.getElementById('progress-bar').style.width = data.percentage + '%';
            document.getElementById('progress-percent').textContent = data.percentage + '%';
            
            // Ø¢Ù¾Ø¯ÛŒØª Ù¾ÛŒØ§Ù…
            const messageEl = document.getElementById('status-message');
            messageEl.textContent = data.message;
            messageEl.style.display = 'block';
            
            if (data.status === 'completed') {
                // ØªÙ…Ø§Ù… Ø´Ø¯
                isRunning = false;
                document.getElementById('start-btn').style.display = 'inline-block';
                document.getElementById('pause-btn').style.display = 'none';
                document.getElementById('resume-btn').style.display = 'none';
                document.getElementById('spinner-container').style.display = 'none';
                document.getElementById('loading-text').textContent = 'ğŸ‰ ØªÙ…Ø§Ù… Ø´Ø¯!';
                messageEl.className = 'message success';
                
                // ØµØ¯Ø§ÛŒ ØªÛŒÚ©
                playSuccessSound();
            } else if (data.status === 'success') {
                // Ø§Ø¯Ø§Ù…Ù‡ Ø¨Ù‡ Ø¨Ø¹Ø¯ÛŒ
                setTimeout(extractNext, 1000);
            } else if (data.status === 'error') {
                // Ø®Ø·Ø§ Ø§Ù…Ø§ Ø§Ø¯Ø§Ù…Ù‡
                messageEl.className = 'message error';
                setTimeout(extractNext, 2000);
            }
        })
        .catch(error => {
            console.error('Error:', error);
            document.getElementById('status-message').textContent = 'âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø·: ' + error.message;
            document.getElementById('status-message').className = 'message error';
            document.getElementById('status-message').style.display = 'block';
            document.getElementById('spinner-container').style.display = 'none';
            isRunning = false;
            document.getElementById('start-btn').style.display = 'inline-block';
            document.getElementById('pause-btn').style.display = 'none';
        });
    }

    function playSuccessSound() {
        // ØµØ¯Ø§ÛŒ Ø³Ø§Ø¯Ù‡ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.frequency.value = 800;
        oscillator.type = 'sine';
        
        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
        
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + 0.5);
    }

    // Ø§Ú¯Ø± Ø§Ø² Ù‚Ø¨Ù„ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¯Ø±Ø­Ø§Ù„â€ŒØ§Ù†Ø¯ØŒ Ù†Ø´Ø§Ù† Ø¨Ø¯Ù‡
    {% if stats.remaining > 0 %}
        // Ø§Ø®ØªÛŒØ§Ø±ÛŒ: Ø®ÙˆØ¯Ú©Ø§Ø± Ø´Ø±ÙˆØ¹
        // startAutoExtraction();
    {% endif %}
</script>
{% endblock %}
